# æ¥é›¨æ°´é—®é¢˜è¯¦è§£

<!-- [æ‰‹æŠŠæ‰‹ææ‡‚æ¥é›¨æ°´é—®é¢˜çš„å¤šç§è§£æ³•](https://mp.weixin.qq.com/s/8E2WHPdArs3KwSwaxFunHw) -->
 
<p align='center'>
<a href="https://github.com/labuladong/fucking-algorithm" target="view_window"><img alt="GitHub" src="https://img.shields.io/github/stars/labuladong/fucking-algorithm?label=Stars&style=flat-square&logo=GitHub"></a>
<a href="https://appktavsiei5995.pc.xiaoe-tech.com/index" target="_blank"><img class="my_header_icon" src="https://img.shields.io/static/v1?label=ç²¾å“è¯¾ç¨‹&message=æŸ¥çœ‹&color=pink&style=flat"></a>
<a href="https://www.zhihu.com/people/labuladong"><img src="https://img.shields.io/badge/%E7%9F%A5%E4%B9%8E-@labuladong-000000.svg?style=flat-square&logo=Zhihu"></a>
<a href="https://space.bilibili.com/14089380"><img src="https://img.shields.io/badge/Bç«™-@labuladong-000000.svg?style=flat-square&logo=Bilibili"></a>
</p>

![](https://labuladong.github.io/algo/images/souyisou1.png)

**é€šçŸ¥ï¼š[æ•°æ®ç»“æ„ç²¾å“è¯¾](https://aep.h5.xeknow.com/s/1XJHEO) å·²æ›´æ–°åˆ° V2.0ï¼›[ç¬¬ 12 æœŸåˆ·é¢˜æ‰“å¡](https://mp.weixin.qq.com/s/eUG2OOzY3k_ZTz-CFvtv5Q) æœ€åä¸€å¤©æŠ¥åï¼›ç‚¹å‡»è¿™é‡Œä½“éªŒ [åˆ·é¢˜å…¨å®¶æ¡¶](https://labuladong.gitee.io/algo/images/others/%E5%85%A8%E5%AE%B6%E6%A1%B6.jpg)ã€‚å¦å¤–ï¼Œå»ºè®®ä½ åœ¨æˆ‘çš„ [ç½‘ç«™](https://labuladong.gitee.io/algo/) å­¦ä¹ æ–‡ç« ï¼Œä½“éªŒæ›´å¥½ã€‚**



è¯»å®Œæœ¬æ–‡ï¼Œä½ ä¸ä»…å­¦ä¼šäº†ç®—æ³•å¥—è·¯ï¼Œè¿˜å¯ä»¥é¡ºä¾¿è§£å†³å¦‚ä¸‹é¢˜ç›®ï¼š

| LeetCode | åŠ›æ‰£ | éš¾åº¦ |
| :----: | :----: | :----: |
| [11. Container With Most Water](https://leetcode.com/problems/container-with-most-water/) | [11. ç››æœ€å¤šæ°´çš„å®¹å™¨](https://leetcode.cn/problems/container-with-most-water/) | ğŸŸ 
| [42. Trapping Rain Water](https://leetcode.com/problems/trapping-rain-water/) | [42. æ¥é›¨æ°´](https://leetcode.cn/problems/trapping-rain-water/) | ğŸ”´

**-----------**

åŠ›æ‰£ç¬¬ 42 é¢˜ã€Œæ¥é›¨æ°´ã€æŒºæœ‰æ„æ€ï¼Œåœ¨é¢è¯•é¢˜ä¸­å‡ºç°é¢‘ç‡è¿˜æŒºé«˜çš„ï¼Œæœ¬æ–‡å°±æ¥æ­¥æ­¥ä¼˜åŒ–ï¼Œè®²è§£ä¸€ä¸‹è¿™é“é¢˜ã€‚

å…ˆçœ‹ä¸€ä¸‹é¢˜ç›®ï¼š

![](https://labuladong.github.io/algo/images/æ¥é›¨æ°´/title.png)

å°±æ˜¯ç”¨ä¸€ä¸ªæ•°ç»„è¡¨ç¤ºä¸€ä¸ªæ¡å½¢å›¾ï¼Œé—®ä½ è¿™ä¸ªæ¡å½¢å›¾æœ€å¤šèƒ½æ¥å¤šå°‘æ°´ã€‚

```java
int trap(int[] height);
```

ä¸‹é¢å°±æ¥ç”±æµ…å…¥æ·±ä»‹ç»æš´åŠ›è§£æ³• -> å¤‡å¿˜å½•è§£æ³• -> åŒæŒ‡é’ˆè§£æ³•ï¼Œåœ¨ O(N) æ—¶é—´ O(1) ç©ºé—´å†…è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

### ä¸€ã€æ ¸å¿ƒæ€è·¯

æ‰€ä»¥å¯¹äºè¿™ç§é—®é¢˜ï¼Œæˆ‘ä»¬ä¸è¦æƒ³æ•´ä½“ï¼Œè€Œåº”è¯¥å»æƒ³å±€éƒ¨ï¼›å°±åƒä¹‹å‰çš„æ–‡ç« å†™çš„åŠ¨æ€è§„åˆ’é—®é¢˜å¤„ç†å­—ç¬¦ä¸²é—®é¢˜ï¼Œä¸è¦è€ƒè™‘å¦‚ä½•å¤„ç†æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œæ˜¯å»æ€è€ƒåº”è¯¥å¦‚ä½•å¤„ç†æ¯ä¸€ä¸ªå­—ç¬¦ã€‚

è¿™ä¹ˆä¸€æƒ³ï¼Œå¯ä»¥å‘ç°è¿™é“é¢˜çš„æ€è·¯å…¶å®å¾ˆç®€å•ã€‚å…·ä½“æ¥è¯´ï¼Œä»…ä»…å¯¹äºä½ç½® `i`ï¼Œèƒ½è£…ä¸‹å¤šå°‘æ°´å‘¢ï¼Ÿ

![](https://labuladong.github.io/algo/images/æ¥é›¨æ°´/0.jpg)

èƒ½è£… 2 æ ¼æ°´ï¼Œå› ä¸º `height[i]` çš„é«˜åº¦ä¸º 0ï¼Œè€Œè¿™é‡Œæœ€å¤šèƒ½ç›› 2 æ ¼æ°´ï¼Œ2-0=2ã€‚

ä¸ºä»€ä¹ˆä½ç½® `i` æœ€å¤šèƒ½ç›› 2 æ ¼æ°´å‘¢ï¼Ÿå› ä¸ºï¼Œä½ç½® `i` èƒ½è¾¾åˆ°çš„æ°´æŸ±é«˜åº¦å’Œå…¶å·¦è¾¹çš„æœ€é«˜æŸ±å­ã€å³è¾¹çš„æœ€é«˜æŸ±å­æœ‰å…³ï¼Œæˆ‘ä»¬åˆ†åˆ«ç§°è¿™ä¸¤ä¸ªæŸ±å­é«˜åº¦ä¸º `l_max` å’Œ `r_max`ï¼›**ä½ç½® i æœ€å¤§çš„æ°´æŸ±é«˜åº¦å°±æ˜¯ `min(l_max, r_max)`**ã€‚

æ›´è¿›ä¸€æ­¥ï¼Œå¯¹äºä½ç½® `i`ï¼Œèƒ½å¤Ÿè£…çš„æ°´ä¸ºï¼š

```python
water[i] = min(
               # å·¦è¾¹æœ€é«˜çš„æŸ±å­
               max(height[0..i]),  
               # å³è¾¹æœ€é«˜çš„æŸ±å­
               max(height[i..end]) 
            ) - height[i]
    
```

![](https://labuladong.github.io/algo/images/æ¥é›¨æ°´/1.jpg)

![](https://labuladong.github.io/algo/images/æ¥é›¨æ°´/2.jpg)

è¿™å°±æ˜¯æœ¬é—®é¢˜çš„æ ¸å¿ƒæ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•å†™ä¸€ä¸ªæš´åŠ›ç®—æ³•ï¼š

```java
int trap(int[] height) {
    int n = height.length;
    int res = 0;
    for (int i = 1; i < n - 1; i++) {
        int l_max = 0, r_max = 0;
        // æ‰¾å³è¾¹æœ€é«˜çš„æŸ±å­
        for (int j = i; j < n; j++)
            r_max = Math.max(r_max, height[j]);
        // æ‰¾å·¦è¾¹æœ€é«˜çš„æŸ±å­
        for (int j = i; j >= 0; j--)
            l_max = Math.max(l_max, height[j]);
        // å¦‚æœè‡ªå·±å°±æ˜¯æœ€é«˜çš„è¯ï¼Œ
        // l_max == r_max == height[i]
        res += Math.min(l_max, r_max) - height[i];
    }
    return res;
}
```

æœ‰ä¹‹å‰çš„æ€è·¯ï¼Œè¿™ä¸ªè§£æ³•åº”è¯¥æ˜¯å¾ˆç›´æ¥ç²—æš´çš„ï¼Œæ—¶é—´å¤æ‚åº¦ O(N^2)ï¼Œç©ºé—´å¤æ‚åº¦ O(1)ã€‚ä½†æ˜¯å¾ˆæ˜æ˜¾è¿™ç§è®¡ç®— `r_max` å’Œ `l_max` çš„æ–¹å¼éå¸¸ç¬¨æ‹™ï¼Œä¸€èˆ¬çš„ä¼˜åŒ–æ–¹æ³•å°±æ˜¯å¤‡å¿˜å½•ã€‚

### äºŒã€å¤‡å¿˜å½•ä¼˜åŒ–

ä¹‹å‰çš„æš´åŠ›è§£æ³•ï¼Œä¸æ˜¯åœ¨æ¯ä¸ªä½ç½® `i` éƒ½è¦è®¡ç®— `r_max` å’Œ `l_max` å—ï¼Ÿæˆ‘ä»¬ç›´æ¥æŠŠç»“æœéƒ½æå‰è®¡ç®—å‡ºæ¥ï¼Œåˆ«å‚»ä¸æ‹‰å‡ çš„æ¯æ¬¡éƒ½éå†ï¼Œè¿™æ—¶é—´å¤æ‚åº¦ä¸å°±é™ä¸‹æ¥äº†å˜›ã€‚

**æˆ‘ä»¬å¼€ä¸¤ä¸ªæ•°ç»„ `r_max` å’Œ `l_max` å……å½“å¤‡å¿˜å½•ï¼Œ`l_max[i]` è¡¨ç¤ºä½ç½® `i` å·¦è¾¹æœ€é«˜çš„æŸ±å­é«˜åº¦ï¼Œ`r_max[i]` è¡¨ç¤ºä½ç½® `i` å³è¾¹æœ€é«˜çš„æŸ±å­é«˜åº¦**ã€‚é¢„å…ˆæŠŠè¿™ä¸¤ä¸ªæ•°ç»„è®¡ç®—å¥½ï¼Œé¿å…é‡å¤è®¡ç®—ï¼š

```java
int trap(int[] height) {
    if (height.length == 0) {
        return 0;
    }
    int n = height.length;
    int res = 0;
    // æ•°ç»„å……å½“å¤‡å¿˜å½•
    int[] l_max = new int[n];
    int[] r_max = new int[n];
    // åˆå§‹åŒ– base case
    l_max[0] = height[0];
    r_max[n - 1] = height[n - 1];
    // ä»å·¦å‘å³è®¡ç®— l_max
    for (int i = 1; i < n; i++)
        l_max[i] = Math.max(height[i], l_max[i - 1]);
    // ä»å³å‘å·¦è®¡ç®— r_max
    for (int i = n - 2; i >= 0; i--)
        r_max[i] = Math.max(height[i], r_max[i + 1]);
    // è®¡ç®—ç­”æ¡ˆ
    for (int i = 1; i < n - 1; i++)
        res += Math.min(l_max[i], r_max[i]) - height[i];
    return res;
}
```

è¿™ä¸ªä¼˜åŒ–å…¶å®å’Œæš´åŠ›è§£æ³•æ€è·¯å·®ä¸å¤šï¼Œå°±æ˜¯é¿å…äº†é‡å¤è®¡ç®—ï¼ŒæŠŠæ—¶é—´å¤æ‚åº¦é™ä½ä¸º O(N)ï¼Œå·²ç»æ˜¯æœ€ä¼˜äº†ï¼Œä½†æ˜¯ç©ºé—´å¤æ‚åº¦æ˜¯ O(N)ã€‚ä¸‹é¢æ¥çœ‹ä¸€ä¸ªç²¾å¦™ä¸€äº›çš„è§£æ³•ï¼Œèƒ½å¤ŸæŠŠç©ºé—´å¤æ‚åº¦é™ä½åˆ° O(1)ã€‚

### ä¸‰ã€åŒæŒ‡é’ˆè§£æ³•

è¿™ç§è§£æ³•çš„æ€è·¯æ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œä½†åœ¨å®ç°æ‰‹æ³•ä¸Šéå¸¸å·§å¦™ï¼Œæˆ‘ä»¬è¿™æ¬¡ä¹Ÿä¸è¦ç”¨å¤‡å¿˜å½•æå‰è®¡ç®—äº†ï¼Œè€Œæ˜¯ç”¨åŒæŒ‡é’ˆ**è¾¹èµ°è¾¹ç®—**ï¼ŒèŠ‚çœä¸‹ç©ºé—´å¤æ‚åº¦ã€‚

é¦–å…ˆï¼Œçœ‹ä¸€éƒ¨åˆ†ä»£ç ï¼š

```java
int trap(int[] height) {
    int left = 0, right = height.length - 1;
    int l_max = 0, r_max = 0;
    
    while (left < right) {
        l_max = Math.max(l_max, height[left]);
        r_max = Math.max(r_max, height[right]);
        // æ­¤æ—¶ l_max å’Œ r_max åˆ†åˆ«è¡¨ç¤ºä»€ä¹ˆï¼Ÿ
        left++; right--;
    }
}
```

å¯¹äºè¿™éƒ¨åˆ†ä»£ç ï¼Œè¯·é—® `l_max` å’Œ `r_max` åˆ†åˆ«è¡¨ç¤ºä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿ

å¾ˆå®¹æ˜“ç†è§£ï¼Œ**`l_max` æ˜¯ `height[0..left]` ä¸­æœ€é«˜æŸ±å­çš„é«˜åº¦ï¼Œ`r_max` æ˜¯ `height[right..end]` çš„æœ€é«˜æŸ±å­çš„é«˜åº¦**ã€‚

æ˜ç™½äº†è¿™ä¸€ç‚¹ï¼Œç›´æ¥çœ‹è§£æ³•ï¼š

```java
int trap(int[] height) {
    int left = 0, right = height.length - 1;
    int l_max = 0, r_max = 0;

    int res = 0;
    while (left < right) {
        l_max = Math.max(l_max, height[left]);
        r_max = Math.max(r_max, height[right]);

        // res += min(l_max, r_max) - height[i]
        if (l_max < r_max) {
            res += l_max - height[left];
            left++;
        } else {
            res += r_max - height[right];
            right--;
        }
    }
    return res;
}
```

ä½ çœ‹ï¼Œå…¶ä¸­çš„æ ¸å¿ƒæ€æƒ³å’Œä¹‹å‰ä¸€æ¨¡ä¸€æ ·ï¼Œæ¢æ±¤ä¸æ¢è¯ã€‚ä½†æ˜¯ç»†å¿ƒçš„è¯»è€…å¯èƒ½ä¼šå‘ç°æ¬¡è§£æ³•è¿˜æ˜¯æœ‰ç‚¹ç»†èŠ‚å·®å¼‚ï¼š

ä¹‹å‰çš„å¤‡å¿˜å½•è§£æ³•ï¼Œ`l_max[i]` å’Œ `r_max[i]` åˆ†åˆ«ä»£è¡¨ `height[0..i]` å’Œ `height[i..end]` çš„æœ€é«˜æŸ±å­é«˜åº¦ã€‚

```java
res += Math.min(l_max[i], r_max[i]) - height[i];
```

![](https://labuladong.github.io/algo/images/æ¥é›¨æ°´/3.jpg)

ä½†æ˜¯åŒæŒ‡é’ˆè§£æ³•ä¸­ï¼Œ`l_max` å’Œ `r_max` ä»£è¡¨çš„æ˜¯ `height[0..left]` å’Œ `height[right..end]` çš„æœ€é«˜æŸ±å­é«˜åº¦ã€‚æ¯”å¦‚è¿™æ®µä»£ç ï¼š

```java
if (l_max < r_max) {
    res += l_max - height[left];
    left++; 
} 
```

![](https://labuladong.github.io/algo/images/æ¥é›¨æ°´/4.jpg)

æ­¤æ—¶çš„ `l_max` æ˜¯ `left` æŒ‡é’ˆå·¦è¾¹çš„æœ€é«˜æŸ±å­ï¼Œä½†æ˜¯ `r_max` å¹¶ä¸ä¸€å®šæ˜¯ `left` æŒ‡é’ˆå³è¾¹æœ€é«˜çš„æŸ±å­ï¼Œè¿™çœŸçš„å¯ä»¥å¾—åˆ°æ­£ç¡®ç­”æ¡ˆå—ï¼Ÿ

å…¶å®è¿™ä¸ªé—®é¢˜è¦è¿™ä¹ˆæ€è€ƒï¼Œæˆ‘ä»¬åªåœ¨ä¹ `min(l_max, r_max)`ã€‚**å¯¹äºä¸Šå›¾çš„æƒ…å†µï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ `l_max < r_max` äº†ï¼Œè‡³äºè¿™ä¸ª `r_max` æ˜¯ä¸æ˜¯å³è¾¹æœ€å¤§çš„ï¼Œä¸é‡è¦ã€‚é‡è¦çš„æ˜¯ `height[i]` èƒ½å¤Ÿè£…çš„æ°´åªå’Œè¾ƒä½çš„ `l_max` ä¹‹å·®æœ‰å…³**ï¼š

![](https://labuladong.github.io/algo/images/æ¥é›¨æ°´/5.jpg)

è¿™æ ·ï¼Œæ¥é›¨æ°´é—®é¢˜å°±è§£å†³äº†ã€‚

### æ‰©å±•å»¶ä¼¸

ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€é“å’Œæ¥é›¨æ°´é—®é¢˜éå¸¸ç±»ä¼¼çš„é¢˜ç›®ï¼ŒåŠ›æ‰£ç¬¬ 11 é¢˜ã€Œç››æœ€å¤šæ°´çš„å®¹å™¨ã€ï¼š

![](https://labuladong.github.io/algo/images/æ¥é›¨æ°´/title1.png)

å‡½æ•°ç­¾åå¦‚ä¸‹ï¼š

```java
int maxArea(int[] height);
```

è¿™é¢˜å’Œæ¥é›¨æ°´é—®é¢˜å¾ˆç±»ä¼¼ï¼Œå¯ä»¥å®Œå…¨å¥—ç”¨å‰æ–‡çš„æ€è·¯ï¼Œè€Œä¸”è¿˜æ›´ç®€å•ã€‚ä¸¤é“é¢˜çš„åŒºåˆ«åœ¨äºï¼š

**æ¥é›¨æ°´é—®é¢˜ç»™å‡ºçš„ç±»ä¼¼ä¸€å¹…ç›´æ–¹å›¾ï¼Œæ¯ä¸ªæ¨ªåæ ‡éƒ½æœ‰å®½åº¦ï¼Œè€Œæœ¬é¢˜ç»™å‡ºçš„æ¯ä¸ªæ¨ªåæ ‡æ˜¯ä¸€æ¡ç«–çº¿ï¼Œæ²¡æœ‰å®½åº¦**ã€‚

æˆ‘ä»¬å‰æ–‡è®¨è®ºäº†åŠå¤© `l_max` å’Œ `r_max`ï¼Œå®é™…ä¸Šéƒ½æ˜¯ä¸ºäº†è®¡ç®— `height[i]` èƒ½å¤Ÿè£…å¤šå°‘æ°´ï¼›è€Œæœ¬é¢˜ä¸­ `height[i]` æ²¡æœ‰äº†å®½åº¦ï¼Œé‚£è‡ªç„¶å°±å¥½åŠå¤šäº†ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœåœ¨æ¥é›¨æ°´é—®é¢˜ä¸­ï¼Œä½ çŸ¥é“äº† `height[left]` å’Œ `height[right]` çš„é«˜åº¦ï¼Œä½ èƒ½ç®—å‡º `left` å’Œ `right` ä¹‹é—´èƒ½å¤Ÿç››ä¸‹å¤šå°‘æ°´å—ï¼Ÿ

ä¸èƒ½ï¼Œå› ä¸ºä½ ä¸çŸ¥é“ `left` å’Œ `right` ä¹‹é—´æ¯ä¸ªæŸ±å­å…·ä½“èƒ½ç››å¤šå°‘æ°´ï¼Œä½ å¾—é€šè¿‡æ¯ä¸ªæŸ±å­çš„ `l_max` å’Œ `r_max` æ¥è®¡ç®—æ‰è¡Œã€‚

åè¿‡æ¥ï¼Œå°±æœ¬é¢˜è€Œè¨€ï¼Œä½ çŸ¥é“äº† `height[left]` å’Œ `height[right]` çš„é«˜åº¦ï¼Œèƒ½ç®—å‡º `left` å’Œ `right` ä¹‹é—´èƒ½å¤Ÿç››ä¸‹å¤šå°‘æ°´å—ï¼Ÿ

å¯ä»¥ï¼Œå› ä¸ºæœ¬é¢˜ä¸­ç«–çº¿æ²¡æœ‰å®½åº¦ï¼Œæ‰€ä»¥ `left` å’Œ `right` ä¹‹é—´èƒ½å¤Ÿç››çš„æ°´å°±æ˜¯ï¼š

```python
min(height[left], height[right]) * (right - left)
```

ç±»ä¼¼æ¥é›¨æ°´é—®é¢˜ï¼Œé«˜åº¦æ˜¯ç”± `height[left]` å’Œ `height[right]` è¾ƒå°çš„å€¼å†³å®šçš„ã€‚

è§£å†³è¿™é“é¢˜çš„æ€è·¯ä¾ç„¶æ˜¯åŒæŒ‡é’ˆæŠ€å·§ï¼š

**ç”¨ `left` å’Œ `right` ä¸¤ä¸ªæŒ‡é’ˆä»ä¸¤ç«¯å‘ä¸­å¿ƒæ”¶ç¼©ï¼Œä¸€è¾¹æ”¶ç¼©ä¸€è¾¹è®¡ç®— `[left, right]` ä¹‹é—´çš„çŸ©å½¢é¢ç§¯ï¼Œå–æœ€å¤§çš„é¢ç§¯å€¼å³æ˜¯ç­”æ¡ˆ**ã€‚

å…ˆç›´æ¥çœ‹è§£æ³•ä»£ç å§ï¼š

```java
int maxArea(int[] height) {
    int left = 0, right = height.length - 1;
    int res = 0;
    while (left < right) {
        // [left, right] ä¹‹é—´çš„çŸ©å½¢é¢ç§¯
        int cur_area = Math.min(height[left], height[right]) * (right - left);
        res = Math.max(res, cur_area);
        // åŒæŒ‡é’ˆæŠ€å·§ï¼Œç§»åŠ¨è¾ƒä½çš„ä¸€è¾¹
        if (height[left] < height[right]) {
            left++;
        } else {
            right--;
        }
    }
    return res;
}
```

ä»£ç å’Œæ¥é›¨æ°´é—®é¢˜å¤§è‡´ç›¸åŒï¼Œä¸è¿‡è‚¯å®šæœ‰è¯»è€…ä¼šé—®ï¼Œä¸‹é¢è¿™æ®µ if è¯­å¥ä¸ºä»€ä¹ˆè¦ç§»åŠ¨è¾ƒä½çš„ä¸€è¾¹ï¼š

```java
// åŒæŒ‡é’ˆæŠ€å·§ï¼Œç§»åŠ¨è¾ƒä½çš„ä¸€è¾¹
if (height[left] < height[right]) {
    left++;
} else {
    right--;
}
```

**å…¶å®ä¹Ÿå¥½ç†è§£ï¼Œå› ä¸ºçŸ©å½¢çš„é«˜åº¦æ˜¯ç”± `min(height[left], height[right])` å³è¾ƒä½çš„ä¸€è¾¹å†³å®šçš„**ï¼š

ä½ å¦‚æœç§»åŠ¨è¾ƒä½çš„é‚£ä¸€è¾¹ï¼Œé‚£æ¡è¾¹å¯èƒ½ä¼šå˜é«˜ï¼Œä½¿å¾—çŸ©å½¢çš„é«˜åº¦å˜å¤§ï¼Œè¿›è€Œå°±ã€Œæœ‰å¯èƒ½ã€ä½¿å¾—çŸ©å½¢çš„é¢ç§¯å˜å¤§ï¼›ç›¸åï¼Œå¦‚æœä½ å»ç§»åŠ¨è¾ƒé«˜çš„é‚£ä¸€è¾¹ï¼ŒçŸ©å½¢çš„é«˜åº¦æ˜¯æ— è®ºå¦‚ä½•éƒ½ä¸ä¼šå˜å¤§çš„ï¼Œæ‰€ä»¥ä¸å¯èƒ½ä½¿çŸ©å½¢çš„é¢ç§¯å˜å¾—æ›´å¤§ã€‚

è‡³æ­¤ï¼Œè¿™é“é¢˜ä¹Ÿè§£å†³äº†ã€‚





**ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿ï¼¿**

**ã€Šlabuladong çš„ç®—æ³•å°æŠ„ã€‹å·²ç»å‡ºç‰ˆï¼Œå…³æ³¨å…¬ä¼—å·æŸ¥çœ‹è¯¦æƒ…ï¼›åå°å›å¤å…³é”®è¯ã€Œ**è¿›ç¾¤**ã€å¯åŠ å…¥ç®—æ³•ç¾¤ï¼›å›å¤ã€Œ**å…¨å®¶æ¡¶**ã€å¯ä¸‹è½½é…å¥— PDF å’Œåˆ·é¢˜å…¨å®¶æ¡¶**ï¼š

![](https://labuladong.github.io/algo/images/souyisou2.png)


======å…¶ä»–è¯­è¨€ä»£ç ======

[42.æ¥é›¨æ°´](https://leetcode-cn.com/problems/trapping-rain-water)



### java

[Yifan Zhang](https://github.com/FanFan0919) æä¾› java ä»£ç 

**åŒæŒ‡é’ˆè§£æ³•**ï¼šæ—¶é—´å¤æ‚åº¦ O(N)ï¼Œç©ºé—´å¤æ‚åº¦ O(1)

å¯¹cppç‰ˆæœ¬çš„è§£æ³•æœ‰éå¸¸å¾®å°çš„ä¼˜åŒ–ã€‚  
å› ä¸ºæˆ‘ä»¬æ¯æ¬¡å¾ªç¯åªä¼šé€‰ left æˆ–è€… right å¤„çš„æŸ±å­æ¥è®¡ç®—ï¼Œå› æ­¤æˆ‘ä»¬å¹¶ä¸éœ€è¦åœ¨æ¯æ¬¡å¾ªç¯ä¸­åŒæ—¶æ›´æ–°`maxLeft`å’Œ`maxRight`ã€‚  
æˆ‘ä»¬å¯ä»¥å…ˆæ¯”è¾ƒ `maxLeft` å’Œ `maxRight`ï¼Œå†³å®šè¿™æ¬¡é€‰æ‹©è®¡ç®—çš„æŸ±å­æ˜¯ `height[left]` æˆ–è€… `height[right]` åå†æ›´æ–°å¯¹åº”çš„ `maxLeft` æˆ– `maxRight`ã€‚  
å½“ç„¶è¿™å¹¶ä¸ä¼šåœ¨æ—¶é—´ä¸Šå¸¦æ¥ä»€ä¹ˆä¼˜åŒ–ï¼Œåªæ˜¯æä¾›ä¸€ç§æ€è·¯ã€‚

```java
class Solution {
    public int trap(int[] height) {
        if (height == null || height.length == 0) return 0;
        int left = 0, right = height.length - 1;
        int maxLeft = height[left], maxRight = height[right];
        int res = 0;
        
        while (left < right) {
            // æ¯”è¾ƒ maxLeft å’Œ maxRightï¼Œå†³å®šè¿™æ¬¡è®¡ç®— left è¿˜æ˜¯ right å¤„çš„æŸ±å­
            if (maxLeft < maxRight) {
                left++;
                maxLeft = Math.max(maxLeft, height[left]);  // update maxLeft
                res += maxLeft - height[left];
            } else {
                right--;
                maxRight = Math.max(maxRight, height[right]);   // update maxRight
                res += maxRight - height[right];
            }
        }
        
        return res;
    }
}
```

é™„ä¸Šæš´åŠ›è§£æ³•ä»¥åŠå¤‡å¿˜å½•è§£æ³•çš„ java ä»£ç 

**æš´åŠ›è§£æ³•**ï¼šæ—¶é—´å¤æ‚åº¦ O(N^2)ï¼Œç©ºé—´å¤æ‚åº¦ O(1)  
```java
class Solution {
    public int trap(int[] height) {
        if (height == null || height.length == 0) return 0;
        int n = height.length;
        int res = 0;
        // è·³è¿‡æœ€å·¦è¾¹å’Œæœ€å³è¾¹çš„æŸ±å­ï¼Œä»ç¬¬äºŒä¸ªæŸ±å­å¼€å§‹
        for (int i = 1; i < n - 1; i++) {
            int maxLeft = 0, maxRight = 0;
            // æ‰¾å³è¾¹æœ€é«˜çš„æŸ±å­
            for (int j = i; j < n; j++) {
                maxRight = Math.max(maxRight, height[j]);
            }
            // æ‰¾å·¦è¾¹æœ€é«˜çš„æŸ±å­
            for (int j = i; j >= 0; j--) {
                maxLeft = Math.max(maxLeft, height[j]);
            }
            // å¦‚æœè‡ªå·±å°±æ˜¯æœ€é«˜çš„è¯ï¼Œ
            // maxLeft == maxRight == height[i]
            res += Math.min(maxLeft, maxRight) - height[i];
        }
        return res;
    }
}
```

**å¤‡å¿˜å½•è§£æ³•**ï¼šæ—¶é—´å¤æ‚åº¦ O(N)ï¼Œç©ºé—´å¤æ‚åº¦ O(N)
```java
class Solution {
    public int trap(int[] height) {
        if (height == null || height.length == 0) return 0;
        int n = height.length;
        int res = 0;
        // æ•°ç»„å……å½“å¤‡å¿˜å½•
        int[] maxLeft = new int[n];
        int[] maxRight = new int[n];
        // åˆå§‹åŒ– base case 
        maxLeft[0] = height[0];
        maxRight[n - 1] = height[n - 1];
        
        // ä»å·¦å‘å³è®¡ç®— maxLeft
        for (int i = 1; i < n; i++) {
            maxLeft[i] = Math.max(maxLeft[i - 1], height[i]);
        }
        // ä»å³å‘å·¦è®¡ç®— maxRight
        for (int i = n - 2; i >= 0; i--) {
            maxRight[i] = Math.max(maxRight[i + 1], height[i]);
        }
        // è®¡ç®—ç­”æ¡ˆ
        for (int i = 1; i < n; i++) {
            res += Math.min(maxLeft[i], maxRight[i]) - height[i];
        }
        return res;
    }
}
```



### javascript

**æš´åŠ›è§£æ³•**

```js
/**
 * @param {number[]} height
 * @return {number}
 */
var trap = function (height) {
    let n = height.length;
    let res = 0;

    for (let i = 1; i <= n - 2; i++) {
        let l_max = 0, r_max = 0;
        // æ‰¾å³è¾¹é«˜çš„æŸ±å­
        for (let j = i; j < n; j++) {
            r_max = Math.max(r_max, height[j])
        }

        // æ‰¾å·¦è¾¹é«˜çš„æŸ±å­
        for (let j = i; j >= 0; j--) {
            l_max = Math.max(l_max, height[j])
        }

        // å¦‚æœè‡ªå·±å°±æ˜¯æœ€é«˜çš„è¯
        // l_max == r_max == height[i]
        res += Math.min(l_max, r_max) - height[i]
    }
    return res;
};
```



**å¤‡å¿˜å½•ä¼˜åŒ–**

```js
/**
 * @param {number[]} height
 * @return {number}
 */
var trap = function (height) {
    let n = height.length;
    if (n <= 2) {
        return 0;
    }

    let res = 0;

    // æ•°ç»„å……å½“å¤‡å¿˜å½•
    let l_max = new Array(n);
    let r_max = new Array(n);

    // åˆå§‹åŒ–base case
    l_max[0] = height[0];
    r_max[n - 1] = height[n - 1];

    // ä»å·¦å¾€å³ç®—l_max
    for (let i = 1; i < n; i++) {
        l_max[i] = Math.max(height[i], l_max[i - 1])
    }

    // ä»å³å¾€å·¦è®¡ç®—r_max
    for (let i = n - 2; i >= 0; i--) {
        r_max[i] = Math.max(height[i], r_max[i + 1])
    }

    // è®¡ç®—ç­”æ¡ˆ
    for (let i = 1; i <= n - 2; i++) {
        res += Math.min(l_max[i], r_max[i]) - height[i];
    }
    
    return res;
};
```



**åŒæŒ‡é’ˆè§£æ³•**

```js
/**
 * @param {number[]} height
 * @return {number}
 */
var trap = function (height) {
    let n = height.length;
    if (n <= 2) {
        return 0;
    }

    let res = 0;

    let left = 0;
    let right = n - 1;

    let l_max = height[0];
    let r_max = height[n - 1];

    while (left <= right) {
        l_max = Math.max(l_max, height[left]);
        r_max = Math.max(r_max, height[right]);

        // res += min(l_max, r_max) - height[i]
        if (l_max < r_max) {
            res += l_max - height[left];
            left++;
        } else {
            res += r_max - height[right];
            right--;
        }
    }
    return res;
};
```

